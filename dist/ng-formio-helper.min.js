!function e(o,r,n){function i(s,a){if(!r[s]){if(!o[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(t)return t(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var m=r[s]={exports:{}};o[s][0].call(m.exports,function(e){var r=o[s][1][e];return i(r?r:e)},m,m.exports,e,o,r,n)}return r[s].exports}for(var t="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,o,r){"use strict";angular.module("ngFormioHelper").config(["formioComponentsProvider",function(e){e.register("resourcefields",{title:"Resource Fields",template:"formio/components/resourcefields.html",controller:["$scope","$rootScope","$http","FormioUtils","AppConfig",function(e,o,r,n,i){var t=e.component,s="";e.resourceComponents=[],o.currentForm&&o.currentForm._id&&(s="&_id__ne="+o.currentForm._id),e.resourceSelect={type:"select",input:!0,label:t.title?t.title:"Select a resource",key:"resource",placeholder:t.placeholder||"",dataSrc:"url",data:{url:t.basePath+"?type=resource"+s},valueProperty:"_id",defaultValue:e.data.resource,template:"<span>{{ item.title }}</span>",multiple:!1,"protected":!1,unique:!1,persistent:!0,validate:{required:t.hasOwnProperty("required")?t.required:!0}},e.propertyField={label:"Resource Property",key:"property",inputType:"text",input:!0,placeholder:"Assign this resource to the following property",prefix:"",suffix:"",type:"textfield",defaultValue:e.data.property,multiple:!1};var a=[];r.get(i.apiUrl+t.basePath+"/"+t.form).then(function(e){n.eachComponent(e.data.components,function(e){"button"!==e.type&&a.push({value:e.key,label:e.label})})}),e.$watch("data.resource",function(o){o&&(e.data.fields=e.data.fields||{},o!==e.data.resource&&(e.data.resource=o),e.resourceComponents=[],r.get(i.apiUrl+t.basePath+"/"+o).then(function(o){n.eachComponent(o.data.components,function(o){"button"!==o.type&&e.resourceComponents.push({type:"select",input:!0,label:o.label,key:o.key,dataSrc:"values",defaultValue:e.data.fields[o.key],data:{values:a},validate:{required:o.validate?o.validate.required:!1}})})}))})}],settings:{input:!0,tableView:!1,builder:!1,inputType:"text",inputMask:"",label:"",key:"textField",placeholder:"",prefix:"",suffix:"",multiple:!1,defaultValue:"","protected":!1,unique:!1,persistent:!0,validate:{required:!1,minLength:"",maxLength:"",pattern:"",custom:"",customPrivate:!1}}})}])},{}],2:[function(e,o,r){"use strict";angular.module("ngFormioHelper").directive("fileread",[function(){return{scope:{fileread:"="},link:function(e,o){o.bind("change",function(o){var r=new FileReader;r.onloadend=function(o){e.$apply(function(){e.fileread=jQuery(o.target.result)})},r.readAsText(o.target.files[0])})}}}])},{}],3:[function(e,o,r){"use strict";angular.module("ngFormioHelper").directive("formioForms",function(){return{restrict:"E",replace:!0,scope:{src:"=",base:"=",tag:"=?"},templateUrl:"formio-helper/form/list.html",controller:["$scope","Formio",function(e,o){e.forms=[];var r={type:"form",limit:9999999},n=function(){e.src&&(e.tag&&(r.tags=e.tag),new o(e.src).loadForms({params:r}).then(function(o){e.forms=o}))};e.$watch("src",n)}]}})},{}],4:[function(e,o,r){"use strict";angular.module("ngFormioHelper").directive("offlineButton",function(){return{restrict:"E",replace:!0,scope:!1,controller:["$scope","$rootScope",function(e,o){e.offline=o.offline,e.hasOfflineMode=o.hasOfflineMode}],templateUrl:"formio-helper/offline/button.html"}})},{}],5:[function(e,o,r){"use strict";angular.module("ngFormioHelper").directive("offlinePopup",function(){return{restrict:"A",scope:!1,link:function(e,o){"undefined"!=typeof jQuery&&jQuery(o).popover()}}})},{}],6:[function(e,o,r){"use strict";angular.module("ngFormioHelper").factory("FormioAlerts",["$rootScope",function(e){var o=[];return{addAlert:function(r){e.alerts.push(r),r.element?angular.element("#form-group-"+r.element).addClass("has-error"):o.push(r)},getAlerts:function(){var e=angular.copy(o);return o.length=0,o=[],e},onError:function r(e){if(e.message)this.addAlert({type:"danger",message:e.message,element:e.path});else{var o=e.hasOwnProperty("errors")?e.errors:e.data.errors;angular.forEach(o,r.bind(this))}}}}])},{}],7:[function(e,o,r){"use strict";angular.module("ngFormioHelper",["formio","ngFormioGrid","ui.router"]).filter("capitalize",[function(){return _.capitalize}]).filter("truncate",[function(){return function(e,o){return _.isNumber(o)&&(o={length:o}),_.truncate(e,o)}}]).run(["$templateCache","$rootScope","$state","FormioUtils",function(e,o,r,n){o.isActive=function(e){return-1!==r.current.name.indexOf(e)},e.put("formio-helper/pager.html",'<div class="paginate-anything">\n  <ul class="pagination pagination-{{size}} links" ng-if="numPages > 1">\n    <li ng-class="{disabled: page <= 0}"><a href ng-click="gotoPage(page-1)">&laquo;</a></li>\n    <li ng-if="linkGroupFirst() > 0"><a href ng-click="gotoPage(0)">1</a></li>\n    <li ng-if="linkGroupFirst() > 1" class="disabled"><a href>&hellip;</a></li>\n    <li ng-repeat="p in [linkGroupFirst(), linkGroupLast()] | makeRange" ng-class="{active: p === page}"><a href ng-click="gotoPage(p)">{{p+1}}</a></li>\n    <li ng-if="linkGroupLast() < numPages - 2" class="disabled"><a href>&hellip;</a></li>\n    <li ng-if="isFinite() && linkGroupLast() < numPages - 1"><a href ng-click="gotoPage(numPages-1)">{{numPages}}</a></li>\n    <li ng-class="{disabled: page >= numPages - 1}"><a href ng-click="gotoPage(page+1)">&raquo;</a></li>\n  </ul>\n</div>\n'),e.put("formio-helper/auth/auth.html",'<div class="col-md-8 col-md-offset-2">\n    <div class="panel panel-default">\n        <div class="panel-heading" style="padding-bottom: 0; border-bottom: none;">\n            <ul class="nav nav-tabs" style="border-bottom: none;">\n                <li role="presentation" ng-class="{active:isActive(\'auth.login\')}"><a ui-sref="auth.login()">Login</a></li>\n                <li role="presentation" ng-class="{active:isActive(\'auth.register\')}"><a ui-sref="auth.register()">Register</a></li>\n            </ul>\n        </div>\n        <div class="panel-body">\n            <div class="row">\n                <div class="col-lg-12">\n                    <div ui-view></div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'),e.put("formio-helper/auth/login.html",'<formio src="currentForm" formio-options="{skipQueue: true}"></formio>'),e.put("formio-helper/auth/register.html",'<formio src="currentForm" formio-options="{skipQueue: true}"></formio>\n'),e.put("formio-helper/resource/resource.html",'<h2>{{ currentResource.name | capitalize }}</h2>\n<ul class="nav nav-tabs" ng-if="isReady">\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.view\')}" ng-if="hasAccess(currentResource.name, [\'read_all\', \'read_own\'])"><a ui-sref="{{ baseName }}.view()">View</a></li>\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.edit\')}" ng-if="hasAccess(currentResource.name, [\'update_all\', \'update_own\'])"><a ui-sref="{{ baseName }}.edit()">Edit</a></li>\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.delete\')}" ng-if="hasAccess(currentResource.name, [\'delete_all\', \'delete_own\'])"><a ui-sref="{{ baseName }}.delete()">Delete</a></li>\n</ul>\n<div ui-view></div>\n'),e.put("formio-helper/resource/create.html",'<h3 ng-if="pageTitle">{{ pageTitle }}</h3>\n<hr ng-if="pageTitle"></hr>\n<formio src="currentResource.formUrl" submission="submission" hide-components="hideComponents"></formio>\n'),e.put("formio-helper/resource/delete.html",'<formio-delete src="currentResource.submissionUrl" resource-name="resourceName"></formio-delete>\n'),e.put("formio-helper/resource/edit.html",'<formio src="currentResource.submissionUrl" hide-components="hideComponents"></formio>\n'),e.put("formio-helper/resource/index.html",'<formio-grid src="currentResource.formUrl" columns="currentResource.columns" query="currentResource.gridQuery" grid-options="currentResource.gridOptions"></formio-grid><br/>\n<a ui-sref="{{ baseName }}Create()" class="btn btn-primary" ng-if="isReady && hasAccess(currentResource.name, [\'create_own\', \'create_all\'])"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New {{ currentResource.name | capitalize }}</a>\n'),e.put("formio-helper/resource/view.html",'<formio src="currentResource.submissionUrl" read-only="true"></formio>\n'),e.put("formio-helper/form/list.html",'<ul class="list-group">\n    <li class="list-group-item" ng-repeat="form in forms | orderBy: \'title\'"><a ui-sref="{{ base }}form.view({formId: form._id})">{{ form.title }}</a></li>\n</ul>\n'),e.put("formio-helper/form/index.html",'<formio-forms src="formsSrc" tag="formsTag" base="formBase"></formio-forms>\n'),e.put("formio-helper/form/form.html",'<ul class="nav nav-tabs">\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.view\')}"><a ui-sref="{{ formBase }}form.view()">Form</a></li>\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.submissions\')}"><a ui-sref="{{ formBase }}form.submissions()">Submissions</a></li>\n</ul>\n<div ui-view style="margin-top:20px;"></div>\n'),e.put("formio-helper/form/view.html",'<formio form="currentForm.form" form-action="currentForm.url + \'/submission\'" submission="submission" hide-components="hideComponents"></formio>\n'),e.put("formio-helper/submission/index.html",'<formio-grid src="currentForm.url" query="submissionQuery" columns="submissionColumns"></formio-grid>\n\n'),e.put("formio-helper/submission/submission.html",'<ul class="nav nav-pills">\n  <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.view\')}"><a ui-sref="{{ formBase }}form.submission.view()">View</a></li>\n  <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.edit\')}"><a ui-sref="{{ formBase }}form.submission.edit()">Edit</a></li>\n  <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.delete\')}"><a ui-sref="{{ formBase }}form.submission.delete()">Delete</a></li>\n</ul>\n<div ui-view style="margin-top:20px;"></div>\n'),e.put("formio-helper/submission/view.html",'<formio form="currentForm.form" submission="currentSubmission.submission" read-only="true"></formio>\n'),e.put("formio-helper/submission/edit.html",'<formio form="currentForm.form" submission="currentSubmission.submission" form-action="currentSubmission.url"></formio>\n'),e.put("formio-helper/submission/delete.html",'<formio-delete src="currentSubmission.url"></formio-delete>\n'),e.put("formio-helper/offline/index.html",'<div>\n    <h2>The following submission had an error. Please correct it and resubmit.</h2>\n    <formio src="currentSubmission.url" submission="currentSubmission.data" hide-components="[\'submit\']"></formio>\n    <a class="btn btn-lg btn-info" ng-click="submitSubmission()">Retry</a>\n    <a class="btn btn-lg btn-warning" ng-click="cancelSubmission()">Cancel Submission</a>\n</div>'),e.put("formio-helper/offline/button.html",'<div class="offline-button">\n    <div ng-if="hasOfflineMode">\n        <span class="navbar-text" ng-click="offline.forceOffline(!offline.isForcedOffline())" style="cursor:pointer;">\n            <i class="glyphicon glyphicon-signal text-success" ng-class="{ \'text-danger\': (offline.isForcedOffline() || !offline.enabled), \'text-warning\' : offline.offline }"></i>\n        </span>\n        <span ng-if="offline.submissionQueueLength()" ng-click="offline.dequeueSubmissions()" class="navbar-text" style="cursor:pointer;">\n            <span class="badge">{{ offline.submissionQueueLength() }} Queued</span> <i class="glyphicon glyphicon-refresh" ng-class="{ \'glyphicon-spin\': offline.dequeuing }"></i>\n        </span>\n    </div>\n    <div ng-if="!hasOfflineMode">\n        <span class="navbar-text">\n            <a tabindex="0" offline-popup role="button" data-toggle="popover" data-placement="bottom" data-trigger="focus" title="Offline Mode Disabled" data-content="You must upgrade your project to Team Pro to enable offline mode support. Please contact support@form.io for more information."><i class="glyphicon glyphicon-signal text-danger"></i></a>\n        </span>\n    </div>\n</div>'),e.put("formio/components/resourcefields.html",n.fieldWrap('<formio-component component="resourceSelect" data="data"></formio-component>\n<formio-component ng-if="data.resource" component="propertyField" data="data"></formio-component>\n<fieldset ng-if="data.resource">\n  <legend>Resource Fields</legend>\n  <div class="well">Below are the fields within the selected resource. For each of these fields, select the corresponding field within this form that you wish to map to the selected Resource.</div>\n  <formio-component ng-repeat="resourceComponent in resourceComponents" component="resourceComponent" data="data.fields"></formio-component>\n</fieldset>\n'))}]),e("./components/resourcefields.js"),e("./directives/fileread.js"),e("./directives/formioForms.js"),e("./directives/offlineButton.js"),e("./directives/offlinePopup.js"),e("./factories/FormioAlerts.js"),e("./providers/FormioAuth.js"),e("./providers/FormioForms.js"),e("./providers/FormioOffline.js"),e("./providers/FormioResource.js")},{"./components/resourcefields.js":1,"./directives/fileread.js":2,"./directives/formioForms.js":3,"./directives/offlineButton.js":4,"./directives/offlinePopup.js":5,"./factories/FormioAlerts.js":6,"./providers/FormioAuth.js":8,"./providers/FormioForms.js":9,"./providers/FormioOffline.js":10,"./providers/FormioResource.js":11}],8:[function(e,o,r){"use strict";angular.module("ngFormioHelper").provider("FormioAuth",["$stateProvider","FormioProvider",function(e,o){var r=!1,n="auth.login",i=!1,t="home",s=[],a=!1,l={},u={};return{setForceAuth:function(e){s="boolean"==typeof e?e?["auth"]:[]:e},setStates:function(e,o){n=e,t=o},setAnonRole:function(e){i=e},setAppUrl:function(e){o.setAppUrl(e)},register:function(o,r,n,i,s){var l=i&&!s;a||(a=!0,e.state("auth",{"abstract":!0,url:"/auth",templateUrl:l?"formio-helper/auth/auth.html":"views/user/auth.html"})),n||(n=o);var u=o.toLowerCase()+".html";e.state("auth."+o,{url:"/"+n,parent:"auth",templateUrl:l?"formio-helper/auth/"+u:"views/user/"+u,controller:["$scope","$state","$rootScope",function(e,o,n){e.currentForm=i,e.$on("formSubmission",function(e,i){i&&(n.setUser(i,r),o.go(t))})}]})},$get:["Formio","FormioAlerts","$rootScope","$state","$stateParams","$http","$q",function(e,o,t,a,m,c,f){return{init:function(){r=!0,t.accessPromise=e.makeStaticRequest(e.getAppUrl()+"/access").then(function(e){return angular.forEach(e.forms,function(e){l[e.name]={},e.submissionAccess.forEach(function(o){l[e.name][o.type]=o.roles})}),u=e.roles,e},function(e){return u={},null}),t.user=null,t.isReady=!1,t.userPromise=e.currentUser().then(function(e){return t.setUser(e,localStorage.getItem("formioRole")),e}),t.hasRole=function(e){return e=e.toLowerCase(),t.user?u[e]?-1!==t.user.roles.indexOf(u[e]._id):!1:"anonymous"===e},t.ifRole=function(e){return t.whenReady.then(function(){return t.isAdmin||t.hasRole(e)})},t.assignRoles=function(){if(!u)return t.isAdmin=!1,!1;for(var e in u)if(u[e].admin&&(t["is"+u[e].title.replace(/\s/g,"")]=t.isAdmin=t.hasRole(e),t.isAdmin))break;for(var e in u)u[e].admin||(t["is"+u[e].title.replace(/\s/g,"")]=t.hasRole(e))},t.whenReady=t.accessPromise.then(t.userPromise).then(function(){return t.isReady=!0,t.assignRoles(),!0}),t.isRole=function(e){return t.role===e.toLowerCase()},t.setUser=function(o,r){o?(t.user=o,localStorage.setItem("formioAppUser",angular.toJson(o))):(t.user=null,localStorage.removeItem("formioAppUser"),e.clearCache(),e.setUser(null)),r?(t.role=r.toLowerCase(),localStorage.setItem("formioAppRole",r)):(t.role=null,localStorage.removeItem("formioAppRole")),t.authenticated=!!e.getToken(),t.assignRoles(),t.$emit("user",{user:t.user,role:t.role})},t.hasAccess=function(e,o){if(!r)return!0;if(Array.isArray(o)||(o=[o]),!l[e])return!1;var n=!1;return o.forEach(function(o){return l[e][o]?void(t.user?t.user.roles.forEach(function(r){-1!==l[e][o].indexOf(r)&&(n=!0)}):-1!==l[e][o].indexOf(i)&&(n=!0)):!1}),n},t.ifAccess=function(e,o){return t.whenReady.then(function(){return t.hasAccess(e,o)})};var c=function(){t.setUser(null,null),localStorage.removeItem("formioToken"),a.go(n,m,{reload:!0,inherit:!1,notify:!0}),o.addAlert({type:"danger",message:"Your session has expired. Please log in again."})};t.$on("formio.sessionExpired",c),e.events.on("formio.badToken",c),e.events.on("formio.sessionExpired",c),t.logout=function(){t.setUser(null,null),localStorage.removeItem("formioToken"),e.logout().then(function(){a.go(n,m,{reload:!0,inherit:!1,notify:!0})})["catch"](c)},t.$on("$stateChangeStart",function(o,r){if(t.authenticated=!!e.getToken(),!t.authenticated&&s.length){var i=!1;for(var l in s)if(0===r.name.indexOf(s[l])){i=!0;break}if(i)return;o.preventDefault(),a.go(n,{},{reload:!0})}}),t.$on("$stateChangeSuccess",function(){t.alerts=o.getAlerts()})}}}]}}])},{}],9:[function(e,o,r){"use strict";angular.module("ngFormioHelper").provider("FormioForms",["$stateProvider",function(e){var o={};return{register:function(o,r,n){n=n||{};var i=n.templates?n.templates:{},t=n.controllers?n.controllers:{},s="string"==typeof n.field?[n.field]:n.field;s=_.map(s,function(e){return"string"==typeof e?{name:e,stateParam:e+"Id"}:e});var a=n.base?n.base:"";a||(a=o?o+".":""),e.state(a+"formIndex",{url:"/forms",params:n.params&&n.params.index,templateUrl:i.index?i.index:"formio-helper/form/index.html",controller:["$scope","Formio","$controller",function(e,o,i){e.formBase=a,e.formsSrc=r+"/form",e.formsTag=e.formsTag||n.tag,t.index&&i(t.index,{$scope:e})}]}).state(a+"form",{url:"/form/:formId","abstract":!0,templateUrl:i.form?i.form:"formio-helper/form/form.html",controller:["$scope","$stateParams","Formio","$controller",function(e,n,i,s){var l=r+"/form/"+n.formId;e.formBase=a,e.currentForm={name:o,url:l,form:{}},e.currentForm.formio=new i(l),e.currentForm.promise=e.currentForm.formio.loadForm().then(function(o){return e.currentForm.form=o,o}),t.form&&s(t.form,{$scope:e})}]}).state(a+"form.view",{url:"/",params:n.params&&n.params.view,templateUrl:i.view?i.view:"formio-helper/form/view.html",controller:["$scope","$state","FormioUtils","$controller",function(e,o,r,n){e.submission={data:{}};var i=!1;if(s&&s.length&&(e.hideComponents=_.map(s,function(e){return e.name}),e.currentForm.promise.then(function(){s.forEach(function(o){var r=o.name.split("."),n=r[r.length-1];e[n].loadSubmissionPromise.then(function(r){_.set(e.submission.data,o.name,r)})})})),t.view){var l=n(t.view,{$scope:e});i=l.handle||!1}i||e.$on("formSubmission",function(){o.go(a+"form.submissions")})}]}).state(a+"form.submissions",{url:"/submissions",params:n.params&&n.params.submissions,templateUrl:i.submissions?i.submissions:"formio-helper/submission/index.html",controller:["$scope","$state","$stateParams","FormioUtils","$controller",function(e,o,r,n,i){e.submissionQuery={},e.submissionColumns=[],s&&s.length&&s.forEach(function(o){e.submissionQuery["data."+o.name+"._id"]=r[o.stateParam]}),e.$on("rowView",function(e,r){o.go(a+"form.submission.view",{formId:r.form,submissionId:r._id})}),t.submissions&&i(t.submissions,{$scope:e}),e.currentForm.promise.then(function(o){localStorage.setItem(o.name,""),e.submissionColumns.length||0!==!Object.keys(e.submissionColumns).length||(n.eachComponent(o.components,function(o){o.key&&o.input&&o.tableView&&(s&&s.length&&!_.find(s,{name:o.key})||e.submissionColumns.push(o.key))}),e.$broadcast("reloadGrid"))})}]}).state(a+"form.submission",{"abstract":!0,url:"/submission/:submissionId",params:n.params&&n.params.submission,templateUrl:i.submission?i.submission:"formio-helper/submission/submission.html",controller:["$scope","$stateParams","Formio","$controller",function(e,o,r,n){e.currentSubmission={url:e.currentForm.url+"/submission/"+o.submissionId,submission:{data:{}}},e.currentSubmission.formio=new r(e.currentSubmission.url),e.currentSubmission.promise=e.currentSubmission.formio.loadSubmission().then(function(o){return e.currentSubmission.submission=o,o}),t.submission&&n(t.submission,{$scope:e})}]}).state(a+"form.submission.view",{url:"/",params:n.params&&n.params.submissionView,templateUrl:i.submissionView?i.submissionView:"formio-helper/submission/view.html",controller:["$scope","$controller",function(e,o){t.submissionView&&o(t.submissionView,{$scope:e})}]}).state(a+"form.submission.edit",{url:"/edit",params:n.params&&n.params.submissionEdit,templateUrl:i.submissionEdit?i.submissionEdit:"formio-helper/submission/edit.html",controller:["$scope","$state","$controller",function(e,o,r){var n=!1;if(t.submissionEdit){var i=r(t.submissionEdit,{$scope:e});n=i.handle||!1}n||e.$on("formSubmission",function(r,n){e.currentSubmission.submission=n,o.go(a+"form.submission.view")})}]}).state(a+"form.submission.delete",{url:"/delete",params:n.params&&n.params.submissionDelete,templateUrl:i.submissionDelete?i.submissionDelete:"formio-helper/submission/delete.html",controller:["$scope","$state","$controller",function(e,o,r){var n=!1;if(t.submissionDelete){var i=r(t.submissionDelete,{$scope:e});n=i.handle||!1}n||(e.$on("delete",function(){o.go(a+"form.submissions")}),e.$on("cancel",function(){o.go(a+"form.submission.view")}))}]})},$get:function(){return o}}}])},{}],10:[function(e,o,r){"use strict";angular.module("ngFormioHelper").provider("FormioOffline",["$stateProvider",function(e){return{register:function(o){o=o||{},e.state("offline",{url:o.errorUrl||"/offline/error",templateUrl:"formio-helper/offline/index.html",params:{currentSubmission:{}},controller:["$scope","$stateParams","$rootScope","$state",function(e,r,n,i){"undefined"!=typeof FormioOfflineProject&&(e.currentSubmission=r.currentSubmission,e.submitSubmission=function(){n.offline.dequeueSubmissions(),i.go(o.homeState||"home")},e.cancelSubmission=function(){n.offline.skipNextQueuedSubmission(),n.offline.dequeueSubmissions()})}]})},$get:["Formio","FormioAlerts","$rootScope","AppConfig","$window","$state",function(e,o,r,n,i,t){return{init:function(){if("undefined"==typeof FormioOfflineProject)return console.log("setting off"),void(r.hasOfflineMode=!1);console.log("setting on"),r.hasOfflineMode=!0,r.appVersion=n.appVersion,r.offline=new FormioOfflineProject(n.appUrl,"project.json"),e.registerPlugin(r.offline,"offline"),r.offline.onError=function(e){o.addAlert({type:"danger",message:"Failed to save offline cache. This could result in missing data."})},e.events.on("offline.formError",function(e,r){o.addAlert({message:e,type:"danger"}),t.go("offline",{currentSubmission:r})});var s=i.applicationCache,a=_.debounce(function(){s.update()},6e4);s&&(s.addEventListener("updateready",function(){s.status==s.UPDATEREADY&&confirm("A new version of the application is available. Would you like to load it?")&&(s.swapCache(),i.location.reload())},!1),r.$on("$stateChangeStart",function(){s.status!==s.UNCACHED&&s.status!==s.OBSOLETE&&a()}))}}}]}}])},{}],11:[function(e,o,r){"use strict";angular.module("ngFormioHelper").provider("FormioResource",["$stateProvider",function(e){var o={};return{register:function(r,n,i){i=i||{},o[r]=i.title||r;var t=i&&i.parent?i.parent:null,s=i&&i.parents?i.parents:[];s&&s.length||!t||(s=[t]);var a=r+"Id";i.base=i.base||"";var l=i.base+r,u=function(e){var o={};return o[a]=e._id,o},m=function(e){return e};i.alter=angular.extend({index:m,create:m,"abstract":m,view:m,edit:m,"delete":m},i.alter);var c=i&&i.templates?i.templates:{},f=i&&i.controllers?i.controllers:{},p=i.query?i.query:"";e.state(l+"Index",i.alter.index({url:"/"+r+p,params:i.params&&i.params.index,templateUrl:c.index?c.index:"formio-helper/resource/index.html",controller:["$scope","$state","$stateParams","$controller",function(e,o,i,t){e.baseName=l;var m={};s.length&&s.forEach(function(e){i.hasOwnProperty(e+"Id")&&(m["data."+e+"._id"]=i[e+"Id"])}),e.currentResource={name:r,queryId:a,formUrl:n,columns:[],gridQuery:m,gridOptions:{}},e.$on("rowView",function(e,r){o.go(l+".view",u(r))}),e.$on("submissionView",function(e,r){o.go(l+".view",u(r))}),e.$on("submissionEdit",function(e,r){o.go(l+".edit",u(r))}),e.$on("submissionDelete",function(e,r){o.go(l+".delete",u(r))}),f.index&&t(f.index,{$scope:e})}]})).state(l+"Create",i.alter.create({url:"/create/"+r+p,params:i.params&&i.params.create,templateUrl:c.create?c.create:"formio-helper/resource/create.html",controller:["$scope","$state","$controller",function(e,o,t){e.baseName=l,e.currentResource={name:r,queryId:a,formUrl:n},e.submission=i.defaultValue?i.defaultValue:{data:{}},e.pageTitle="New "+_.capitalize(r);var m=!1;if(f.create){var c=t(f.create,{$scope:e});m=c.handle||!1}s.length&&(e.hideComponents||(e.hideComponents=[]),e.hideComponents=e.hideComponents.concat(s),s.forEach(function(o){e[o].loadSubmissionPromise.then(function(r){e.submission.data[o]=r})})),m||e.$on("formSubmission",function(r,n){e.currentResource.resource=n,o.go(l+".view",u(n))})}]})).state(l,i.alter["abstract"]({"abstract":!0,url:"/"+r+"/:"+a,templateUrl:c["abstract"]?c["abstract"]:"formio-helper/resource/resource.html",controller:["$scope","$stateParams","Formio","$controller","$http",function(e,o,t,u,m){var c=n,p=i.endpoint;p?p+="/"+o[a]:c+="/submission/"+o[a],e.baseName=l,e.currentResource=e[r]={name:r,queryId:a,formUrl:n,submissionUrl:c,formio:new t(c),resource:{},form:{},href:"/#/"+r+"/"+o[a]+"/",parent:1===s.length?e[s[0]]:{href:"/#/",name:"home"}},e.currentResource.loadFormPromise=e.currentResource.formio.loadForm().then(function(o){return e.currentResource.form=e[r].form=o,o}),i.endpoint?e.currentResource.loadSubmissionPromise=m.get(p,{headers:{"x-jwt-token":t.getToken()}}).then(function(o){return e.currentResource.resource=o.data,o.data}):e.currentResource.loadSubmissionPromise=e.currentResource.formio.loadSubmission().then(function(o){return e.currentResource.resource=e[r].submission=o,o}),f["abstract"]&&u(f["abstract"],{$scope:e})}]})).state(l+".view",i.alter.view({url:"/",params:i.params&&i.params.view,templateUrl:c.view?c.view:"formio-helper/resource/view.html",controller:["$scope","$controller",function(e,o){f.view&&o(f.view,{$scope:e})}]})).state(l+".edit",i.alter.edit({url:"/edit",params:i.params&&i.params.edit,templateUrl:c.edit?c.edit:"formio-helper/resource/edit.html",controller:["$scope","$state","$controller",function(e,o,r){var n=!1;if(s.length&&(e.hideComponents||(e.hideComponents=[]),e.hideComponents=e.hideComponents.concat(s)),f.edit){var i=r(f.edit,{$scope:e});n=i.handle||!1}n||e.$on("formSubmission",function(r,n){e.currentResource.resource=n,o.go(l+".view",u(n))})}]})).state(l+".delete",i.alter["delete"]({url:"/delete",params:i.params&&i.params["delete"],templateUrl:c["delete"]?c["delete"]:"formio-helper/resource/delete.html",controller:["$scope","$state","$controller",function(e,o,n){var i=!1;if(e.resourceName=r,f["delete"]){var t=n(f["delete"],{$scope:e});i=t.handle||!1}i||(e.$on("delete",function(){1===s.length&&"home"!==s[0]?o.go(s[0]+".view"):o.go("home",null,{reload:!0})}),e.$on("cancel",function(){o.go(l+"Index")}))}]}))},$get:function(){return o}}}])},{}]},{},[7]);